---
---
---

# Системы координат в ГИС {#crs}

## Общие сведения о картографических проекциях

**Картографическая проекция** --- это математически определенное отображение поверхности эллипсоида или шара (глобуса) на плоскость карты.

Проекция устанавливает однозначное соответствие между геодезическими координатами точек (широтой и долготой) и их прямоугольными координатами на карте[^crs-1].

[^crs-1]: Берлянт А. М. Картография: Учебник для вузов. --- М.: Аспект Пресс, 2002.- 336 с.

При создании картографической проекции поверхность Земли (поверхность эллипсоида) проецируется, как правило, на плоскость, цилиндр, конус или многогранник. Таким образом, в зависимости от проецирующей поверхности все картографические проекции делятся на **азимутальные, цилиндрические, конические и многогранные**.

![Коническая проекция](images/conic%20projections.png)

![Цилиндрические проекции](images/cilindrical%20projections.png)

![Азимутальные проекции[^crs-2]](images/azimuthal%20projections.png)

[^crs-2]: <http://desktop.arcgis.com/ru/arcmap/10.3/guide-books/map-projections/projection-types.htm>

От выбора проекции зависит степень искажения размеров, длин и углов. Есть мнение, что проекции создают нашу картину мира, о чем есть великий эпизод из сериала [West Wing](https://www.kinopoisk.ru/series/94224/).

```{=html}
<iframe width="800" height="400" src="https://www.youtube.com/embed/vVX-PrBRtTY" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
```
И также достаточно известный выпуск выб-комикса [xkcd](https://xkcd.com/977/). Небольшой разбор комикса на русском можно почитать на [хабре](https://habr.com/ru/post/458426/) или вот [здесь](https://brilliantmaps.com/xkcd/) на английском.

[![](images/map_projections.png)](https://xkcd.com/977/)

Как уже было сказано чуть выше самой распространенной проекцией, с которой большинство из нас сталкивается практически ежедневно, является проекция Меркатора, так как она используется во всех навигационных приложениях и веб-картах. В этой проекции очень велики искажения размеров, особенно в приполярных областях, так как она является цилиндрической. То есть при ее создании земной шар помещается внутрь цилиндра, который соприкасается с ним на экваторе, после чего все проецируется на поверхность цилиндра и он разворачивается на плоскость.

Посмотреть, насколько искажаются размеры в привычной нам проекции можно на сайте [The True Size ...](https://thetruesize.com/)

[![Искажения проекции Меркатора](images/mercator-head.jfif)](https://twitter.com/scienceshitpost)

В картографии для оценки искажений проекций используют **эллипсы Тиссо или эллипсы искажений** - бесконечно малый эллипс в любой точке карты, являющийся отображением бесконечно малой окружности в соответствующей точке на поверхности земного эллипсоида или шара. [^crs-3]

[^crs-3]: <http://www.gisa.ru/13458.html>

Эллипс искажений - индикатриса, большая ось которой отражает направление наибольшего масштаба длин в данной точке, малая ось -- направление наименьшего масштаба длин, а сжатие -- искажение форм.

![Эллипсы Тиссо на глобусе (не искаженные)](images/Tissot_world_from_space.png){width="723"}

![Эллипсы Тиссо для проекции Меркатора](images/Tissot_mercator.png){width="752"}

![Эллипсы Тиссо для проекции Галля-Питерса](images/Tissot_Gall-Peters.png){width="752"}

> Очень важно помнить, что проекция сильно влияет на получившийся результат и восприятие карты, а также на различные измерения, осуществляемые по карте.

Вот [тут](https://bl.ocks.org/syntagmatic/ba569633d51ebec6ec6e) и [тут](https://map-projections.net/imglist.php) можно посравнивать различные проекции между собой, или посоздавать [проекции, центрированные на конкретной стране](https://engaging-data.com/country-centered-map-projections/).

А вот [здесь](https://philogb.github.io/page/myriahedral/) можно посмотреть на различные нестандартные многоугольные проекции.

## Системы координат

Но в ГИС все не ограничивается только способом проецирования на плоскость, также важно как и задаются оси координат, где находится начало системы координат, какие единицы измерения используются, каков охват системы координат. Поэтому в ГИС говорят не просто о проекции, а о системе координат - **coordinate reference system или crs**.

Система координат состоит из нескольких компонентов:

-   датум - поверхность относимости; элипсоид, на который происходит проецирование поверхности Земли;

-   поверхность, на которую проецируется изображение с элипсоида;

-   оси и их направление, начало координат, единицы измерения и прочее.

> Следует помнить, что существует два основных типа систем координат: **географические и прямоугольные (спроецированные)**. В первых в качестве единиц измерения используются градусы, а во вторых - метрические единицы. Это имеет значение при измерениях и при ряде операций пространственного анализа.

Сейчас используется единая классификация систем координат в ГИС - реестр EPSG, с которым можно ознакомиться на сайте [epsg.io](epsg.io) (формально неофициальный источник, но гораздо более простой в использовании и понятный, чем [официальный](https://epsg.org/home.html)).

Этот реестр был изначально разработан European Petroleum survey group (собственно это и есть расшифровка аббревиатуры EPSG, но сейчас она существует уже сама по себе).

Наиболее часто встречающимися явялются системы координат `EPSG:3857 - WGS 84 / Pseudo Mercator` и `EPSG:4326`. Это очень похожие системы координат, основанные на эллипсоиде WGS-84 и проекции Меркатора , главная разница между этими системами в единицах измерения: в первой в качестве единиц измерения используются метры, а во второй - градусы.

Все имеющиеся в реестре системы координат уже заданы в QGIS, а также есть возможность создания пользовательских систем координат.

При создании пользовательской системы координат можно составить ее описание в формате **WKT** (well-known text) или в формате **proj.**

Описания систем координат во всех применяемых в ГИС форматах можно посмотреть на странице соответствующей системы координат на [epsg.io](epsg.io)

### WKT

В настоящее время используется вторая версия формата WKT - WKT 2. Этот формат начали применять в QGIS в версиях 3.х.

Главная особенность данного формата в том, что он допускает возможность преобразований.[^crs-4]

[^crs-4]: Местные системы координат в WKT 2 <https://gis-lab.info/qa/msk-wkt2.html>

Международный формат описания WKT закреплен [стандартом](https://www.ogc.org/standards/wkt-crs) Open Geospatial Consortium.

Пример описания системы координат [EPSG: 3857](https://epsg.io/3857)

    PROJCS["WGS 84 / Pseudo-Mercator",
        GEOGCS["WGS 84",
            DATUM["WGS_1984",
                SPHEROID["WGS 84",6378137,298.257223563,
                    AUTHORITY["EPSG","7030"]],
                AUTHORITY["EPSG","6326"]],
            PRIMEM["Greenwich",0,
                AUTHORITY["EPSG","8901"]],
            UNIT["degree",0.0174532925199433,
                AUTHORITY["EPSG","9122"]],
            AUTHORITY["EPSG","4326"]],
        PROJECTION["Mercator_1SP"],
        PARAMETER["central_meridian",0],
        PARAMETER["scale_factor",1],
        PARAMETER["false_easting",0],
        PARAMETER["false_northing",0],
        UNIT["metre",1,
            AUTHORITY["EPSG","9001"]],
        AXIS["X",EAST],
        AXIS["Y",NORTH],
        EXTENSION["PROJ4","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs"],
        AUTHORITY["EPSG","3857"]]

### proj

Описание в этом формате делается в виде строки с определенной структурой.

Построено описание на основе библиотеки картографических проекций и в прочих сервисах и программах, работающих с этой библиотекой. На сайте библиотеки можно ознакомиться со [структурой строки](https://proj.org/usage/projections.html) и [описаниями целого ряда проекций](https://proj.org/operations/projections/index.html).

+---------------+---------------------------------------------------------------------------------+
| **Parameter** | **Description**                                                                 |
+:==============+=================================================================================+
| +a            | Semimajor radius of the ellipsoid axis                                          |
+---------------+---------------------------------------------------------------------------------+
| +axis         | Axis orientation                                                                |
+---------------+---------------------------------------------------------------------------------+
| +b            | Semiminor radius of the ellipsoid axis                                          |
+---------------+---------------------------------------------------------------------------------+
| +ellps        | Ellipsoid name (see `proj -le`)                                                 |
+---------------+---------------------------------------------------------------------------------+
| +k            | Scaling factor (deprecated)                                                     |
+---------------+---------------------------------------------------------------------------------+
| +k_0          | Scaling factor                                                                  |
+---------------+---------------------------------------------------------------------------------+
| +lat_0        | Latitude of origin                                                              |
+---------------+---------------------------------------------------------------------------------+
| +lon_0        | Central meridian                                                                |
+---------------+---------------------------------------------------------------------------------+
| +lon_wrap     | Center longitude to use for wrapping (see below)                                |
+---------------+---------------------------------------------------------------------------------+
| +over         | Allow longitude output outside -180 to 180 range, disables wrapping (see below) |
+---------------+---------------------------------------------------------------------------------+
| +pm           | Alternate prime meridian (typically a city name, see below)                     |
+---------------+---------------------------------------------------------------------------------+
| +proj         | Projection name (see `proj -l`)                                                 |
+---------------+---------------------------------------------------------------------------------+
| +units        | meters, US survey feet, etc.                                                    |
+---------------+---------------------------------------------------------------------------------+
| +vunits       | vertical units.                                                                 |
+---------------+---------------------------------------------------------------------------------+
| +x_0          | False easting                                                                   |
+---------------+---------------------------------------------------------------------------------+
| +y_0          | False northing                                                                  |
+---------------+---------------------------------------------------------------------------------+

Пример описания системы координат [EPSG: 3857](https://epsg.io/3857)

    +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs

Для подбора подходящей системы координат можно пользоваться сервисом [Projection wizard](http://projectionwizard.org/).
